<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CSC Global Reach Map</title>
  <style>
    :root {
      --bg: #0b0d10;
      --ocean: #0e141b;
      --land: #1b222c;
      --stroke: #2f3a46;
      --highlight: #0ea5e9; /* change to your brand accent */
      --highlight-ghost: rgba(14,165,233,0.2);
      --grid: rgba(255,255,255,0.05);
      --text: #e6eef7;
      --muted: #9eb1c7;
    }

    html, body {
      height: 100%;
      background: var(--bg);
      color: var(--text);
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }

    .wrap {
      min-height: 100%;
      display: grid;
      grid-template-rows: auto 1fr auto;
      gap: 16px;
    }

    header, footer { padding: 16px 20px; }
    header h1 { font-size: 18px; margin: 0 0 2px 0; letter-spacing: 0.2px; }
    header p { margin: 0; color: var(--muted); font-size: 13px; }

    .map-card {
      position: relative;
      margin: 0 auto;
      width: min(1100px, 96vw);
      background: linear-gradient(180deg, #0b0f14 0%, #0b0f14 60%, #0a0c10 100%);
      border: 1px solid #11161d;
      border-radius: 18px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.02);
      overflow: hidden;
    }

    .map-head {
      display: flex; align-items: center; justify-content: space-between;
      padding: 14px 16px; border-bottom: 1px solid #121820;
    }
    .legend { display: flex; gap: 14px; align-items: center; color: var(--muted); font-size: 12px; }
    .dot { width: 10px; height: 10px; border-radius: 999px; display: inline-block; background: var(--highlight); box-shadow: 0 0 0 3px var(--highlight-ghost); }

    .map {
      width: 100%; height: auto; display: block;
      background: radial-gradient(1000px 500px at 50% 80%, rgba(14,165,233,0.06), transparent 60%),
                  radial-gradient(1200px 700px at 50% -10%, rgba(255,255,255,0.06), transparent 60%),
                  var(--ocean);
    }

    .graticule { fill: none; stroke: var(--grid); stroke-width: 0.5; }

    .country { fill: var(--land); stroke: var(--stroke); stroke-width: 0.4; }
    .country.hl { fill: var(--highlight); stroke: #89d8ff; stroke-width: 0.6; filter: drop-shadow(0 0 6px rgba(14,165,233,0.6)); }

    .tooltip {
      position: absolute; pointer-events: none; z-index: 10;
      background: rgba(9,12,16,0.9);
      color: var(--text);
      border: 1px solid #1b2733; border-radius: 10px; padding: 8px 10px;
      font-size: 12px; line-height: 1.2; white-space: nowrap;
      box-shadow: 0 6px 24px rgba(0,0,0,0.35);
      transform: translate(-50%, -120%);
      opacity: 0; transition: opacity .15s ease;
    }

    .footer-note { color: var(--muted); font-size: 12px; }
    .btn {
      background: rgba(255,255,255,0.06); color: var(--text);
      border: 1px solid #1b2530; padding: 8px 10px; border-radius: 10px;
      font-size: 12px; cursor: pointer;
    }
    .btn:hover { background: rgba(255,255,255,0.1); }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>CSC Global Reach</h1>
      <p>Outlined world map with highlighted countries where CSC has delivered work.</p>
    </header>

    <section class="map-card">
      <div class="map-head">
        <div class="legend"><span class="dot"></span> Active project footprint</div>
        <div>
          <button class="btn" id="fitBtn" title="Fit map to viewport">Fit to view</button>
        </div>
      </div>
      <svg id="map" class="map" viewBox="0 0 1100 560" role="img" aria-label="World map with highlighted CSC countries"></svg>
      <div id="tooltip" class="tooltip" aria-hidden="true"></div>
    </section>

    <footer>
      <div class="footer-note">Change the highlight color in <code>:root --highlight</code>. Tasmania is included as part of Australia. Data source: world-atlas, Natural Earth 110m.</div>
    </footer>
  </div>

  <!-- D3 and TopoJSON -->
  <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
  <script src="https://cdn.jsdelivr.net/npm/topojson-client@3"></script>

  <script>
  // Countries to highlight by common name in world-atlas country-names.tsv
  const HIGHLIGHT = new Set([
    'United States',
    'Canada',
    'Mexico',
    'Australia', // Tasmania included
    'China',
    'United Kingdom',
    'India',
    'Brazil',
    'South Africa',
    'Bahrain',
    'Iran',
    'Indonesia'
  ]);

  const svg = d3.select('#map');
  const g = svg.append('g');

  const projection = d3.geoNaturalEarth1()
    .rotate([0, 0])
    .precision(0.1)
    .fitExtent([[12, 12], [1088, 548]], {type: 'Sphere'});

  const path = d3.geoPath(projection);

  const defs = svg.append('defs');
  defs.append('radialGradient')
    .attr('id', 'glowFill')
    .selectAll('stop')
    .data([
      {o: 0.0, c: 'rgba(14,165,233,0.12)'},
      {o: 0.7, c: 'rgba(14,165,233,0.02)'},
      {o: 1.0, c: 'rgba(14,165,233,0.0)'}
    ])
    .enter().append('stop')
      .attr('offset', d => d.o)
      .attr('stop-color', d => d.c);

  const sphere = { type: 'Sphere' };

  const graticule = d3.geoGraticule();
  g.append('path')
    .attr('class', 'graticule')
    .attr('d', path(graticule()));

  // Ocean outline
  g.append('path')
    .attr('fill', 'url(#glowFill)')
    .attr('d', path(sphere));

  const tooltip = d3.select('#tooltip');

  Promise.all([
    d3.json('https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json'),
    d3.tsv('https://cdn.jsdelivr.net/npm/world-atlas@2/country-names.tsv')
  ]).then(([world, names]) => {
    const countryById = new Map(names.map(d => [d.id, d.name]));

    const countries = topojson.feature(world, world.objects.countries).features;

    // Draw countries
    g.selectAll('path.country')
      .data(countries, d => d.id)
      .join('path')
      .attr('class', d => {
        const name = countryById.get(d.id);
        return HIGHLIGHT.has(name) ? 'country hl' : 'country';
      })
      .attr('d', path)
      .on('mousemove', (event, d) => {
        const name = countryById.get(d.id) || 'Unknown';
        const isHL = HIGHLIGHT.has(name);
        tooltip.html(`<strong>${name}</strong>${isHL ? '<br/>CSC projects present' : ''}`)
          .style('left', `${event.offsetX}px`)
          .style('top', `${event.offsetY}px`)
          .style('opacity', 1)
          .attr('aria-hidden', 'false');
      })
      .on('mouseleave', () => {
        tooltip.style('opacity', 0).attr('aria-hidden', 'true');
      });

    // Fit button zoom to bounds of highlighted countries
    document.getElementById('fitBtn').addEventListener('click', () => {
      const highlighted = countries.filter(d => HIGHLIGHT.has(countryById.get(d.id)));
      if (!highlighted.length) return;
      const merge = { type: 'FeatureCollection', features: highlighted };
      const b = path.bounds(merge);
      const dx = b[1][0] - b[0][0];
      const dy = b[1][1] - b[0][1];
      const cx = (b[0][0] + b[1][0]) / 2;
      const cy = (b[0][1] + b[1][1]) / 2;
      const scale = Math.max(1, Math.min(8, 0.9 / Math.max(dx / 1100, dy / 560)));
      const translate = [1100 / 2 - scale * cx, 560 / 2 - scale * cy];
      g.transition().duration(800).attr('transform', `translate(${translate[0]},${translate[1]}) scale(${scale})`);
    });
  }).catch(err => {
    console.error(err);
  });
  </script>
</body>
</html>
